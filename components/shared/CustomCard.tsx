import * as React from "react";
import { cn } from "@/lib/utils";

export interface CustomCardProps extends React.HTMLAttributes<HTMLDivElement> {
  children: React.ReactNode;
  headerContent?: React.ReactNode;
  fillColor?: string;
  headerColor?: string;
  width?: number | string;
  height?: number | string;
  svgVariant?: "first" | "second" | "business";
}

export function CustomCard({
  children,
  headerContent,
  className,
  fillColor = "#F4FAFA",
  headerColor = "#30A0A6",
  width = 400,
  height = 913,
  svgVariant = "second",
  ...props
}: CustomCardProps) {
  const w = typeof width === "number" ? `${width}px` : width;
  const h = typeof height === "number" ? `${height}px` : height;

  // Calculate header height and cloud divider ratios based on variant
  const isBusiness = svgVariant === "business";
  const baseHeight = isBusiness ? 663 : 913;
  const headerHeightRatio = 230 / baseHeight;
  const cloudHeightRatio = 92 / baseHeight;

  // SVG variants
  const svgPaths = {
    first: {
      viewBox: "0 0 400 823",
      path: "M0 30C0 13.4315 13.4315 0 30 0H370C386.569 0 400 13.4315 400 30V792.463C400 809.619 385.637 823.282 368.502 822.425L28.5018 805.425C12.5356 804.627 0 791.449 0 775.463V30Z",
      headerViewBox: "0 0 400 230",
      headerPath: "M0 30C0 13.4315 13.4315 0 30 0H370C386.569 0 400 13.4315 400 30V230H0V30Z",
      cloudViewBox: "0 0 400 92",
      cloudPaths: [
        "M166.806 11.736C166.008 0.105815 147.218 2.89769 145.278 11.736C140.49 6.52245 133.998 9.67668 133.333 12.8516C128.889 6.57673 118.204 12.2897 117.207 17.4698C100.05 5.83965 88.1131 14.2949 84.2893 19.9763C79.9002 17.9711 77.1405 20.8118 76.3092 22.4827C75.5112 15.6651 69.9917 16.3001 67.3317 17.4698C65.3367 8.24589 60.2421 10.2045 57.0833 11.8755C55.3329 9.03317 50.3741 11.0388 50.3741 13.9607C42.793 11.1534 34.4444 17.4698 35.2778 22.4827C32.4848 20.4776 30.1389 22.4827 30.1389 25.5407C28.1439 23.9365 23.3333 26.3773 22.0833 31.1183C21.1111 27.0745 18.1944 24.2857 13.3333 26.3773C13.3333 16.1981 3.47222 9.78387 0 10.9529V92H400V16.4672C384.04 2.02975 362.917 8.94723 357.606 18.4724C340 12.8516 335.556 28.0506 340 36.9748C335.611 36.9748 332.835 41.0308 333.666 43.5373C330.556 38.927 325.788 39.7636 325.139 42.5525C327.591 32.0252 318.889 30.7 315.711 33.0101C314.167 27.4929 307.361 27.7717 305.417 32.2338C296.111 23.4491 280.278 29.5845 278.056 36.9748C278.854 26.5478 272.917 23.0307 268.333 24.8435C267.361 16.6165 258.472 15.6404 255 20.5208C255 14.3853 250.833 12.991 248.472 14.3853C246.667 -2.62637 229.028 -1.51084 221.528 2.95124C218.472 -1.65029 212.361 -0.25591 211.25 2.95121C201.275 0.544943 198.279 5.93989 198.611 10.9529C195.818 10.1508 188.969 13.2156 187.639 14.3853C182.851 11.177 176.968 14.0246 175.139 15.3614C173.144 10.5489 169.167 9.64435 166.806 11.736Z",
      ],
    },
    second: {
      viewBox: "0 0 400 913",
      path: "M0 30C0 13.4314 13.4315 0 30 0H370C386.569 0 400 13.4315 400 30V865.463C400 881.449 387.464 894.627 371.498 895.425L31.4981 912.425C14.3626 913.282 0 899.619 0 882.463V30Z",
      headerViewBox: "0 0 400 230",
      headerPath: "M0 30C0 13.4315 13.4315 0 30 0H370C386.569 0 400 13.4315 400 30V230H0V30Z",
      cloudViewBox: "0 0 400 92",
      cloudPaths: [
        "M166.806 11.736C166.008 0.105815 147.218 2.89769 145.278 11.736C140.49 6.52245 133.998 9.67668 133.333 12.8516C128.889 6.57673 118.204 12.2897 117.207 17.4698C100.05 5.83965 88.1131 14.2949 84.2893 19.9763C79.9002 17.9711 77.1405 20.8118 76.3092 22.4827C75.5112 15.6651 69.9917 16.3001 67.3317 17.4698C65.3367 8.24589 60.2421 10.2045 57.0833 11.8755C55.3329 9.03317 50.3741 11.0388 50.3741 13.9607C42.793 11.1534 34.4444 17.4698 35.2778 22.4827C32.4848 20.4776 30.1389 22.4827 30.1389 25.5407C28.1439 23.9365 23.3333 26.3773 22.0833 31.1183C21.1111 27.0745 18.1944 24.2857 13.3333 26.3773C13.3333 16.1981 3.47222 9.78387 0 10.9529V92H400V16.4672C384.04 2.02975 362.917 8.94723 357.606 18.4724C340 12.8516 335.556 28.0506 340 36.9748C335.611 36.9748 332.835 41.0308 333.666 43.5373C330.556 38.927 325.788 39.7636 325.139 42.5525C327.591 32.0252 318.889 30.7 315.711 33.0101C314.167 27.4929 307.361 27.7717 305.417 32.2338C296.111 23.4491 280.278 29.5845 278.056 36.9748C278.854 26.5478 272.917 23.0307 268.333 24.8435C267.361 16.6165 258.472 15.6404 255 20.5208C255 14.3853 250.833 12.991 248.472 14.3853C246.667 -2.62637 229.028 -1.51084 221.528 2.95124C218.472 -1.65029 212.361 -0.25591 211.25 2.95121C201.275 0.544943 198.279 5.93989 198.611 10.9529C195.818 10.1508 188.969 13.2156 187.639 14.3853C182.851 11.177 176.968 14.0246 175.139 15.3614C173.144 10.5489 169.167 9.64435 166.806 11.736Z",
      ],
    },
    business: {
      viewBox: "0 0 820 663",
      path: "M0 30C0 13.4315 13.4315 0 30 0H790C806.569 0 820 13.4315 820 30V632.501C820 649.643 805.66 663.301 788.538 662.465L28.5383 625.392C12.557 624.613 0 611.428 0 595.428V30Z",
      headerViewBox: "0 0 820 230",
      headerPath: "M0 30C0 13.4315 13.4315 0 30 0H790C806.568 0 820 13.4315 820 30V230H0V30Z",
      cloudViewBox: "0 0 820 92",
      cloudPaths: [
        "M811.806 11.736C811.008 0.105815 792.218 2.89769 790.278 11.736C785.49 6.52245 778.998 9.67668 778.333 12.8516C773.889 6.57673 763.204 12.2897 762.207 17.4698C745.05 5.83965 733.113 14.2949 729.289 19.9763C724.9 17.9711 722.14 20.8118 721.309 22.4827C720.511 15.6651 714.992 16.3001 712.332 17.4698C710.337 8.24589 705.242 10.2045 702.083 11.8755C700.333 9.03317 695.374 11.0388 695.374 13.9607C687.793 11.1534 679.444 17.4698 680.278 22.4827C677.485 20.4776 675.139 22.4827 675.139 25.5407C673.144 23.9365 668.333 26.3773 667.083 31.1183C666.111 27.0745 663.194 24.2857 658.333 26.3773C658.333 16.1981 648.472 9.78387 645 10.9529V92H1045V16.4672C1029.04 2.02975 1007.92 8.94723 1002.61 18.4724C985 12.8516 980.556 28.0506 985 36.9748C980.611 36.9748 977.835 41.0308 978.666 43.5373C975.556 38.927 970.788 39.7636 970.139 42.5525C972.591 32.0252 963.889 30.7 960.711 33.0101C959.167 27.4929 952.361 27.7717 950.417 32.2338C941.111 23.4491 925.278 29.5845 923.056 36.9748C923.854 26.5478 917.917 23.0307 913.333 24.8435C912.361 16.6165 903.472 15.6404 900 20.5208C900 14.3853 895.833 12.991 893.472 14.3853C891.667 -2.62637 874.028 -1.51084 866.528 2.95124C863.472 -1.65029 857.361 -0.25591 856.25 2.95121C846.275 0.544943 843.279 5.93989 843.611 10.9529C840.818 10.1508 833.969 13.2156 832.639 14.3853C827.851 11.177 821.968 14.0246 820.139 15.3614C818.144 10.5489 814.167 9.64435 811.806 11.736Z",
        "M478.194 11.736C478.992 0.105815 497.782 2.89769 499.722 11.736C504.51 6.52245 511.002 9.67668 511.667 12.8516C516.111 6.57673 526.796 12.2897 527.793 17.4698C544.95 5.83965 556.887 14.2949 560.711 19.9763C565.1 17.9711 567.86 20.8118 568.691 22.4827C569.489 15.6651 575.008 16.3001 577.668 17.4698C579.663 8.24589 584.758 10.2045 587.917 11.8755C589.667 9.03317 594.626 11.0388 594.626 13.9607C602.207 11.1534 610.556 17.4698 609.722 22.4827C612.515 20.4776 614.861 22.4827 614.861 25.5407C616.856 23.9365 621.667 26.3773 622.917 31.1183C623.889 27.0745 626.806 24.2857 631.667 26.3773C631.667 16.1981 641.528 9.78387 645 10.9529V92H245V16.4672C260.96 2.02975 282.083 8.94723 287.394 18.4724C305 12.8516 309.444 28.0506 305 36.9748C309.389 36.9748 312.165 41.0308 311.334 43.5373C314.444 38.927 319.212 39.7636 319.861 42.5525C317.409 32.0252 326.111 30.7 329.289 33.0101C330.833 27.4929 337.639 27.7717 339.583 32.2338C348.889 23.4491 364.722 29.5845 366.944 36.9748C366.146 26.5478 372.083 23.0307 376.667 24.8435C377.639 16.6165 386.528 15.6404 390 20.5208C390 14.3853 394.167 12.991 396.528 14.3853C398.333 -2.62637 415.972 -1.51084 423.472 2.95124C426.528 -1.65029 432.639 -0.25591 433.75 2.95121C443.725 0.544943 446.721 5.93989 446.389 10.9529C449.182 10.1508 456.031 13.2156 457.361 14.3853C462.149 11.177 468.032 14.0246 469.861 15.3614C471.856 10.5489 475.833 9.64435 478.194 11.736Z",
        "M11.8056 11.736C11.0076 0.105815 -7.78229 2.89769 -9.72221 11.736C-14.5103 6.52245 -21.0016 9.67668 -21.6667 12.8516C-26.1111 6.57673 -36.7955 12.2897 -37.793 17.4698C-54.9501 5.83965 -66.8869 14.2949 -70.7107 19.9763C-75.0998 17.9711 -77.8595 20.8118 -78.6908 22.4827C-79.4888 15.6651 -85.0083 16.3001 -87.6683 17.4698C-89.6633 8.24589 -94.7579 10.2045 -97.9167 11.8755C-99.6671 9.03317 -104.626 11.0388 -104.626 13.9607C-112.207 11.1534 -120.556 17.4698 -119.722 22.4827C-122.515 20.4776 -124.861 22.4827 -124.861 25.5407C-126.856 23.9365 -131.667 26.3773 -132.917 31.1183C-133.889 27.0745 -136.806 24.2857 -141.667 26.3773C-141.667 16.1981 -151.528 9.78387 -155 10.9529V92H245V16.4672C229.04 2.02975 207.917 8.94723 202.606 18.4724C185 12.8516 180.556 28.0506 185 36.9748C180.611 36.9748 177.835 41.0308 178.666 43.5373C175.556 38.927 170.788 39.7636 170.139 42.5525C172.591 32.0252 163.889 30.7 160.711 33.0101C159.167 27.4929 152.361 27.7717 150.417 32.2338C141.111 23.4491 125.278 29.5845 123.056 36.9748C123.854 26.5478 117.917 23.0307 113.333 24.8435C112.361 16.6165 103.472 15.6404 100 20.5208C100 14.3853 95.8334 12.991 93.4722 14.3853C91.6667 -2.62637 74.0278 -1.51084 66.5278 2.95124C63.4722 -1.65029 57.3611 -0.25591 56.25 2.95121C46.2749 0.544943 43.2786 5.93989 43.6111 10.9529C40.8181 10.1508 33.9689 13.2156 32.6389 14.3853C27.8509 11.177 21.9677 14.0246 20.1389 15.3614C18.1439 10.5489 14.1667 9.64435 11.8056 11.736Z",
      ],
    },
  };

  const currentSvg = svgPaths[svgVariant || "second"];

  return (
    <div
      className={cn("relative isolate", className)}
      style={{ width: w, height: h }}
      {...props}
    >
      {/* Main Card SVG Background */}
      <svg
        viewBox={currentSvg.viewBox}
        className="absolute inset-0 w-full h-full"
        preserveAspectRatio="none"
        aria-hidden
      >
        <path
          d={currentSvg.path}
          fill={fillColor}
        />
      </svg>

      {/* Header SVG - Overlays the top section */}
      <svg
        viewBox={currentSvg.headerViewBox}
        className="absolute top-0 left-0 w-full z-10"
        style={{ height: `${headerHeightRatio * 100}%` }}
        preserveAspectRatio="none"
        aria-hidden
      >
        <path
          d={currentSvg.headerPath}
          fill={headerColor}
        />
      </svg>

      {/* Cloud Divider - Between header and content */}
      <svg
        viewBox={currentSvg.cloudViewBox}
        className="absolute left-0 w-full z-10"
        style={{
          top: `${headerHeightRatio * 100}%`,
          height: `${cloudHeightRatio * 100}%`,
          transform: "translateY(-50%)",
          zIndex: 15,
        }}
        preserveAspectRatio="none"
        aria-hidden
      >
        {currentSvg.cloudPaths.map((path, index) => (
          <path key={index} d={path} fill={fillColor} />
        ))}
      </svg>

      {/* Header Content - Above cloud divider */}
      {headerContent && (
        <div
          className="absolute top-0 left-0 w-full z-20 p-4 pb-4"
          style={{ height: `${headerHeightRatio * 100}%` }}
        >
          {headerContent}
        </div>
      )}

      {/* Body Content - Below cloud divider */}
      <div
        className="absolute left-0 w-full z-20 px-6 pt-6 pb-4 flex flex-col"
        style={{
          top: `${(headerHeightRatio + cloudHeightRatio * 0.5) * 100}%`,
          height: `${(1 - headerHeightRatio - cloudHeightRatio * 0.5) * 100}%`,
        }}
      >
        {children}
      </div>
    </div>
  );
}
